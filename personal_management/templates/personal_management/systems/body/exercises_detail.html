<section class="card body-card body-detail body-exercise-library">
    <style>
        .body-exercise-library {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .body-exercise-header {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: space-between;
            align-items: center;
        }
        .body-exercise-metrics {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            font-size: 0.85rem;
            color: var(--fg-muted);
        }
        .body-exercise-metrics span {
            padding: 0.35rem 0.6rem;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.12);
        }
        .exercise-table {
            display: grid;
            gap: 1rem;
        }
        .exercise-row {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 1rem;
            padding: 1.1rem 1.3rem;
            display: grid;
            gap: 1rem;
        }
        @media (min-width: 1000px) {
            .exercise-row {
                grid-template-columns: 2.2fr 1.6fr 1.2fr 1.6fr;
                align-items: stretch;
            }
        }
        .exercise-meta {
            display: flex;
            flex-direction: column;
            gap: 0.35rem;
        }
        .exercise-meta strong {
            font-size: 1.05rem;
            letter-spacing: 0.04em;
        }
        .exercise-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            font-size: 0.8rem;
            color: var(--fg-muted);
        }
        .exercise-tags span {
            padding: 0.25rem 0.55rem;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.12);
        }
        .exercise-muscles {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
            font-size: 0.9rem;
        }
        .exercise-muscles strong {
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.08em;
            color: rgba(255, 255, 255, 0.6);
        }
        .exercise-media {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            justify-content: flex-start;
        }
        .exercise-media img {
            width: 120px;
            height: 80px;
            border-radius: 0.75rem;
            object-fit: cover;
            border: 1px solid rgba(255, 255, 255, 0.12);
        }
        .btn-ghost {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.45rem 0.75rem;
            border-radius: 0.6rem;
            border: 1px solid rgba(255, 255, 255, 0.16);
            background: transparent;
            color: var(--fg-primary);
            text-decoration: none;
            font-size: 0.85rem;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }
        .btn-ghost:hover {
            border-color: rgba(255, 255, 255, 0.3);
        }
        .exercise-cues {
            font-size: 0.9rem;
            color: var(--fg-muted);
            line-height: 1.6;
        }
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        .pagination a,
        .pagination span {
            padding: 0.4rem 0.75rem;
            border-radius: 0.6rem;
            border: 1px solid rgba(255, 255, 255, 0.12);
            text-decoration: none;
            color: var(--fg-muted);
            font-size: 0.85rem;
        }
        .pagination .active {
            color: var(--fg-primary);
            border-color: rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.08);
        }
        .pagination .disabled {
            opacity: 0.4;
            pointer-events: none;
        }
    </style>

    <div class="body-exercise-header">
        <div>
            <h3>Exercise Library</h3>
            <p class="lead">Complete roster of movements available for programming. Refine technique, equipment, and muscle focus here.</p>
        </div>
        <div class="body-exercise-metrics">
            <span>{{ body_exercise_count }} total movements</span>
            {% if body_exercises_page %}
                <span>Page {{ body_exercises_page.number }} of {{ body_exercises_page.paginator.num_pages }}</span>
            {% endif %}
        </div>
    </div>

    {% if body_exercises_page and body_exercises_page.object_list %}
        <div class="exercise-table">
            {% for exercise in body_exercises_page %}
                <article class="exercise-row">
                    <div class="exercise-meta">
                        <strong>{{ exercise.name }}</strong>
                        <div class="exercise-tags">
                            <span>{{ exercise.category.name }}</span>
                            <span>{{ exercise.get_equipment_display }}</span>
                        </div>
                    </div>
                    <div class="exercise-muscles">
                        <div>
                            <strong>Primary</strong>
                            <p>{{ exercise.primary_muscles_display }}</p>
                        </div>
                        <div>
                            <strong>Secondary</strong>
                            <p>{{ exercise.secondary_muscles_display|default:"—" }}</p>
                        </div>
                    </div>
                    <div class="exercise-media">
                        {% if exercise.image_url %}
                            <a href="{{ exercise.image_url }}" target="_blank" rel="noopener">
                                <img src="{{ exercise.image_url }}" alt="{{ exercise.name }} image">
                            </a>
                        {% endif %}
                        {% if exercise.video_url %}
                            <a class="btn-ghost" href="{{ exercise.video_url }}" target="_blank" rel="noopener">Watch video</a>
                        {% endif %}
                        {% if not exercise.image_url and not exercise.video_url %}
                            <span class="empty-state">No media yet</span>
                        {% endif %}
                    </div>
                    <div class="exercise-cues">
                        {% if exercise.coaching_cues %}
                            {{ exercise.coaching_cues|linebreaksbr }}
                        {% else %}
                            <span class="empty-state">No coaching notes yet.</span>
                        {% endif %}
                    </div>
                </article>
            {% endfor %}
        </div>

        {% if body_exercises_pagination %}
            <nav class="pagination">
                {% if body_exercises_page.has_previous %}
                    <a href="?app=body&body_view=exercises&page={{ body_exercises_page.previous_page_number }}">Prev</a>
                {% else %}
                    <span class="disabled">Prev</span>
                {% endif %}

                {% for marker in body_exercises_pagination %}
                    {% if marker %}
                        {% if marker == body_exercises_page.number %}
                            <span class="active">{{ marker }}</span>
                        {% else %}
                            <a href="?app=body&body_view=exercises&page={{ marker }}">{{ marker }}</a>
                        {% endif %}
                    {% else %}
                        <span>…</span>
                    {% endif %}
                {% endfor %}

                {% if body_exercises_page.has_next %}
                    <a href="?app=body&body_view=exercises&page={{ body_exercises_page.next_page_number }}">Next</a>
                {% else %}
                    <span class="disabled">Next</span>
                {% endif %}
            </nav>
        {% endif %}
    {% else %}
        <p class="empty-state">No exercises yet. Start documenting your movement standards in the Body system.</p>
    {% endif %}
</section>
